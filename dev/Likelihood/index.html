<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Parametric likelihood functions · LSurvival: survival analysis for left-truncated, right-censored outcomes</title><meta name="title" content="Parametric likelihood functions · LSurvival: survival analysis for left-truncated, right-censored outcomes"/><meta property="og:title" content="Parametric likelihood functions · LSurvival: survival analysis for left-truncated, right-censored outcomes"/><meta property="twitter:title" content="Parametric likelihood functions · LSurvival: survival analysis for left-truncated, right-censored outcomes"/><meta name="description" content="Documentation for LSurvival: survival analysis for left-truncated, right-censored outcomes."/><meta property="og:description" content="Documentation for LSurvival: survival analysis for left-truncated, right-censored outcomes."/><meta property="twitter:description" content="Documentation for LSurvival: survival analysis for left-truncated, right-censored outcomes."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LSurvival: survival analysis for left-truncated, right-censored outcomes</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Help</a></li><li class="is-active"><a class="tocitem" href>Parametric likelihood functions</a><ul class="internal"><li><a class="tocitem" href="#Definitions:"><span>Definitions:</span></a></li><li><a class="tocitem" href="#Likelihood-for-survival-data"><span>Likelihood for survival data</span></a></li><li><a class="tocitem" href="#Parametric-likelihoods"><span>Parametric likelihoods</span></a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Parametric likelihood functions</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Parametric likelihood functions</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/alexpkeil1/LSurvival.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/alexpkeil1/LSurvival.jl/blob/main/docs/src/Likelihood.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Likelihood-functions-for-time-to-event-observations-subject-to-left-truncation-and-right-censoring"><a class="docs-heading-anchor" href="#Likelihood-functions-for-time-to-event-observations-subject-to-left-truncation-and-right-censoring">Likelihood functions for time-to-event observations subject to left-truncation and right censoring</a><a id="Likelihood-functions-for-time-to-event-observations-subject-to-left-truncation-and-right-censoring-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-functions-for-time-to-event-observations-subject-to-left-truncation-and-right-censoring" title="Permalink"></a></h1><h2 id="Definitions:"><a class="docs-heading-anchor" href="#Definitions:">Definitions:</a><a id="Definitions:-1"></a><a class="docs-heading-anchor-permalink" href="#Definitions:" title="Permalink"></a></h2><ul><li>Random variable <span>$E$</span>: time at beginning of observation</li><li>Random variable <span>$T$</span>: time at end of observation</li><li>Random variable <span>$Y$</span>: event indicator (1=yes, 0=no)</li><li>Realization <span>$e_i$</span>: time at study entry for observation <span>$i$</span></li><li>Realization <span>$t_i$</span>: time at study end for observation <span>$i$</span></li><li>Realization <span>$y_i$</span>: event indicator (1=yes, 0=no) for observation <span>$i$</span></li><li>Realization <span>$\mathbf{x}_i$</span>: covariate vector for observation <span>$i$</span></li><li>Function <span>$f(t)$</span>: probability density function evaluated at <span>$T=t$</span></li><li>Function <span>$S(t)=Pr(T&gt;t)$</span>: survival function evaluated at <span>$T=t$</span>, where <span>$S(0)= 1$</span></li><li>Function <span>$\mathscr{L} \equiv\mathscr{L}(t,e,y;\theta)$</span>: likelihood function for observed data under a parametric distribution with parameters <span>$\theta$</span></li></ul><h2 id="Likelihood-for-survival-data"><a class="docs-heading-anchor" href="#Likelihood-for-survival-data">Likelihood for survival data</a><a id="Likelihood-for-survival-data-1"></a><a class="docs-heading-anchor-permalink" href="#Likelihood-for-survival-data" title="Permalink"></a></h2><p>We then have that the likelihood for i.i.d. data decomposes as</p><p class="math-container">\[\begin{aligned}
\mathscr{L} =&amp; \prod_i \mathscr{L}_i\\
\mathscr{L}_i =&amp; \frac{f(t_i)^{y_i}S(t_i)^{(1-y_i)}}{S(e_i)}
\end{aligned}\]</p><p>With the log-likelihood (<span>$\ln\mathscr{L}$</span>) given as:</p><p class="math-container">\[\begin{aligned}
\ln\mathscr{L} =&amp; \ln\bigg(\prod_i \mathscr{L}_i\bigg)\\
   =&amp; \sum_i \ln\mathscr{L}_i\\
\ln\mathscr{L}_i =&amp; {y_i}\ln f(t_i) + (1-y_i)\ln S(t_i) - \ln S(e_i)
\end{aligned}\]</p><p>Meaning that the likelihood (and log-likelihood) under a survival model need only have the probability density function and the survival function (or natural log-transformations of those function outputs)</p><h3 id="Special-case:-person-period-data"><a class="docs-heading-anchor" href="#Special-case:-person-period-data">Special case: person-period data</a><a id="Special-case:-person-period-data-1"></a><a class="docs-heading-anchor-permalink" href="#Special-case:-person-period-data" title="Permalink"></a></h3><p>&quot;Person period data&quot; allows us to split data from an individual into multiple observations, so that an individual can be right-censored in their first observation and then left-truncated in their second observation at the same time. In this case, the likelihood contribution for individual <span>$i$</span> (<span>$E_i=e_i, T_i=t_i$</span>, <span>$y_i=1$</span>) can be split over two person-periods (<span>$j\in {1,2}$</span>), where the failure occurs in the second period and the first period is right censored since we know the individual survives that period. This likelihood decomposition is given as:</p><p class="math-container">\[\begin{aligned}
\mathscr{L}_i =&amp; \prod_j \mathscr{L}_{ij}\\
 =&amp; \prod_j\frac{f(t_{ij})^{y_{ij}}S(t_{ij})^{(1-y_{ij})}}{S(e_{ij})} \\
 =&amp; \frac{f(t_{ij})^{y_{ij}}S(t_{ij})^{(1-y_{ij})}}{S(e_{ij})} \times \frac{f(t_{ij})^{y_{ij}}S(t_{ij})^{(1-y_{ij})}}{S(e_{ij})}  \\
 =&amp; \frac{S(t_{i1})}{S(e_{ij}= e_i)} \times \frac{f(t_{i2}=t_i)^{y_{i2}=y_i}}{S(e_{i2}=t_{i1})} =  \frac{f(t_i)}{{S(e_i)}}
\end{aligned}\]</p><p>Which is exactly the likelihood we would observe if there were only one observation for this individual. Similar derivations can be made for censored individuals. This phenomena allows that, for example, covariates may differ across person-periods (time-varying covariates), and the general approach to likelihoods to survival data can readily accomodate this. The <code>LSurvival</code> module takes this general approach to defining the likelihood (and also the partial likelihood in Cox models) and so allows the estimation of effects of time-varying exposures as well as accomodating left truncation and right censoring. </p><h2 id="Parametric-likelihoods"><a class="docs-heading-anchor" href="#Parametric-likelihoods">Parametric likelihoods</a><a id="Parametric-likelihoods-1"></a><a class="docs-heading-anchor-permalink" href="#Parametric-likelihoods" title="Permalink"></a></h2><p>Multiple parametric model forms are available in the <code>LSurvival</code> module. Here, we derive the specific parameterizations used in the module, which uses the location-scale characterization of regression models (also used in the <code>survival</code> package in <code>R</code>).</p><h3 id="Weibull-distribution"><a class="docs-heading-anchor" href="#Weibull-distribution">Weibull distribution</a><a id="Weibull-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Weibull-distribution" title="Permalink"></a></h3><p>The Weibull distribution can be parameterized as: (Kalbfleisch and Prentice, sec 2.2) <span>$\begin{aligned}  f(t)=&amp;\lambda\gamma(\lambda t)^{\gamma-1}\exp(-(\lambda t)^{\gamma}) \\
S(t) =&amp; \exp(-(\lambda t)^{\gamma}) \end{aligned}$</span></p><p>This can be characterized in terms of a &#39;location-scale&#39; parameterization for modeling of survival times.</p><h4 id="Derivation:"><a class="docs-heading-anchor" href="#Derivation:">Derivation:</a><a id="Derivation:-1"></a><a class="docs-heading-anchor-permalink" href="#Derivation:" title="Permalink"></a></h4><p>Let <span>$\gamma = \exp(-\rho), \lambda = \exp(-\alpha), z=\frac{\ln(t)-\alpha}{exp(\rho)}$</span> and using <span>$t=\exp(\ln(t))$</span>, we have that <span>$\begin{aligned}  f(t)=&amp;\exp(-\alpha)\exp(-\rho)(\exp(-\alpha)\exp(\ln(t)))^{\exp(-\rho)-1}\exp(-(\exp(-\alpha) \exp(\ln(t)))^{\exp(-\rho)}) \\
=&amp;\exp(-\alpha-\rho)\exp((\ln(t)-\alpha)(\exp(-\rho)-1))\exp(-(\exp(-\alpha) \exp(\ln(t))\exp(-\rho))) \\
\\
\ln f(t)= &amp; (-\alpha-\rho) +                   (\ln(t)-\alpha)(\exp(-\rho)-1) +                   -\exp(\ln(t)-\alpha)\exp(-\rho)) \\
= &amp; (-\alpha-\rho) +                   (z-(\ln(t)-\alpha)) +                   -\exp(z) \\
= &amp; z -\exp(z) -\rho -\ln(t)  \\
\end{aligned}$</span></p><p>And  <span>$\begin{aligned}  S(t)=&amp;\exp(-(exp(-\alpha) \exp(\ln(t)))^{\exp(-\rho)}) \\
=&amp;\exp(-(\exp((\ln(t)-\alpha)\exp(-\rho))^{}) \\
=&amp;\exp(-\exp(z)) \\
\ln S(t)=&amp;-\exp(z) \\
\end{aligned}$</span></p><p>So that the log likelihood can be defined in terms of the natural log of the survival time, allowing the &quot;location-scale&quot; parameterization of a parametric survival model:</p><p class="math-container">\[\begin{aligned} 
z_i =&amp; \frac{\ln(t_i)-\mathbf{x}_i\beta}{\sigma}\\
\ln(t_i) =&amp; \mathbf{x}_i\beta + \sigma z_i\\
z \sim D
\end{aligned}\]</p><p>Where the location parameter is given as <span>$\alpha = \mathbf{x}\beta$</span> and the scale parmameter <span>$\sigma=\exp(\rho)$</span> determines the magnitude of the error terms, whose distribution is <span>$D$</span> (e.g. in the case of the Weibull distribution for <span>$t$</span>, <span>$D$</span> is the extreme value distribution). Here, the association between covariates <span>$\mathbf{X}$</span> and the time-to-event outcome is characterized in terms of linear effects on the location parameter <span>$\alpha$</span>. Further details and interpretive assistance can be found in Kalbfleisch and Prentice.</p><h3 id="Exponential-distribution"><a class="docs-heading-anchor" href="#Exponential-distribution">Exponential distribution</a><a id="Exponential-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Exponential-distribution" title="Permalink"></a></h3><p>This is a special case of the Weibull log-likelihood in which <span>$\gamma=1$</span> (or, equivalently <span>$\rho=0$</span>)</p><p class="math-container">\[\begin{aligned} 
f(t)=&amp;\lambda\exp(-\lambda t) \\
S(t) =&amp; \exp(-\lambda t)
\end{aligned}\]</p><p>Then, again letting <span>$\lambda = \exp(-\alpha)$</span> and using <span>$t=\exp(\ln(t))$</span>, we have that</p><p class="math-container">\[\begin{aligned} 
\ln f(t)= &amp; \alpha - \exp(\ln(t) - \alpha) \\
\ln S(t)=&amp;-\exp(\ln(t) - \alpha) \\
\end{aligned}\]</p><p>which gives us the model</p><p class="math-container">\[\begin{aligned} 
\ln(t_i) =&amp; \mathbf{x}_i\beta + \epsilon_i \\
\epsilon \sim D
\end{aligned}\]</p><h3 id="Log-normal-distribution"><a class="docs-heading-anchor" href="#Log-normal-distribution">Log-normal distribution</a><a id="Log-normal-distribution-1"></a><a class="docs-heading-anchor-permalink" href="#Log-normal-distribution" title="Permalink"></a></h3><p class="math-container">\[\begin{aligned} 
f(t)=&amp;(2\pi)^{-1/2}\gamma t^{-1} \exp\bigg(\frac{-\gamma^2(\ln(\lambda t))^2}{2}   \bigg) \\
S(t) =&amp; 1 - \Phi\big(\gamma \ln(\lambda t)\big)
\end{aligned}\]</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Help</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Friday 22 September 2023 22:54">Friday 22 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
