<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Non-parametric survival analysis · LSurvival: survival analysis for left-truncated, right-censored outcomes</title><meta name="title" content="Non-parametric survival analysis · LSurvival: survival analysis for left-truncated, right-censored outcomes"/><meta property="og:title" content="Non-parametric survival analysis · LSurvival: survival analysis for left-truncated, right-censored outcomes"/><meta property="twitter:title" content="Non-parametric survival analysis · LSurvival: survival analysis for left-truncated, right-censored outcomes"/><meta name="description" content="Documentation for LSurvival: survival analysis for left-truncated, right-censored outcomes."/><meta property="og:description" content="Documentation for LSurvival: survival analysis for left-truncated, right-censored outcomes."/><meta property="twitter:description" content="Documentation for LSurvival: survival analysis for left-truncated, right-censored outcomes."/><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../search_index.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">LSurvival: survival analysis for left-truncated, right-censored outcomes</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../">Help</a></li><li><span class="tocitem">Parametric likelihood functions</span><ul><li><a class="tocitem" href="../Likelihood/">Likelihood functions for time-to-event observations subject to left-truncation and right censoring</a></li></ul></li><li><span class="tocitem">Examples</span><ul><li class="is-active"><a class="tocitem" href>Non-parametric survival analysis</a><ul class="internal"><li><a class="tocitem" href="#Plot-survival-curve"><span>Plot survival curve</span></a></li><li class="toplevel"><a class="tocitem" href="#Kaplan-Meier-estimator-of-the-cumulative-risk/survival"><span>Kaplan-Meier estimator of the cumulative risk/survival</span></a></li><li class="toplevel"><a class="tocitem" href="#Checking-whether-marginal-distribution-of-the-outcome-comports-with-a-parametric-Weibull-or-Exponential-model"><span>Checking whether marginal distribution of the outcome comports with a parametric Weibull or Exponential model</span></a></li><li class="toplevel"><a class="tocitem" href="#Competing-event-analysis:-Aalen-Johansen-estimator-of-cumulative-risk"><span>Competing event analysis: Aalen-Johansen estimator of cumulative risk</span></a></li><li><a class="tocitem" href="#Aalen-Johansen-plot:-marginal-cause-specific-risks"><span>Aalen-Johansen plot: marginal cause-specific risks</span></a></li></ul></li><li><a class="tocitem" href="../coxmodel/">Semi-parametric survival analysis with Cox models</a></li><li><a class="tocitem" href="../parametric/">Parametric survival analysis with AFT models</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Non-parametric survival analysis</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Non-parametric survival analysis</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/alexpkeil1/LSurvival.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/alexpkeil1/LSurvival.jl/blob/main/docs/src/nonparametric.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Non-parametric-survival/risk-estimation-with-plotting"><a class="docs-heading-anchor" href="#Non-parametric-survival/risk-estimation-with-plotting">Non-parametric survival/risk estimation with plotting</a><a id="Non-parametric-survival/risk-estimation-with-plotting-1"></a><a class="docs-heading-anchor-permalink" href="#Non-parametric-survival/risk-estimation-with-plotting" title="Permalink"></a></h1><pre><code class="language-julia hljs">cd(&quot;docs/src/examples/fig/&quot;)
using Random, LSurvival, Distributions, LinearAlgebra, Plots

# generate some data under a discrete hazards model
id, int, out, data = LSurvival.dgm(MersenneTwister(1212), 100, 20)

data[:, 1] = round.(data[:, 1], digits = 3)
d, X = data[:, 4], data[:, 1:3]
wt = rand(MersenneTwister(1212), length(d)) # random weights just to demonstrate usage


# Kaplan-Meier curve
mfit = kaplan_meier(int, out, d, wts = wt, id = ID.(id))</code></pre><p>Output:</p><pre><code class="language-outputa hljs">Kaplan-Meier Survival
────────────────────────────────────────
    time   survival   # events   at risk
────────────────────────────────────────
1    1.0  0.886358    5.73763   50.4885
2    2.0  0.684543   10.3561    45.4832
3    3.0  0.622066    3.30175   36.1763
4    4.0  0.534651    4.26077   30.3209
5    5.0  0.469165    2.652     21.6518
6    6.0  0.396423    3.57466   23.0554
7    7.0  0.298113    5.09531   20.5463
8    8.0  0.287853    0.388946  11.3009
9    9.0  0.216842    3.24547   13.156
10  10.0  0.195417    0.965415   9.77109
11  11.0  0.167813    1.43976   10.1925
12  12.0  0.140082    0.998202   6.04051
13  13.0  0.126733    0.58481    6.13692
14  16.0  0.10436     0.867046   4.91143
15  20.0  0.0986266   0.270987   4.93256
────────────────────────────────────────
Number of events:  43.7388
Number of unique event times:       15</code></pre><h2 id="Plot-survival-curve"><a class="docs-heading-anchor" href="#Plot-survival-curve">Plot survival curve</a><a id="Plot-survival-curve-1"></a><a class="docs-heading-anchor-permalink" href="#Plot-survival-curve" title="Permalink"></a></h2><h1 id="Kaplan-Meier-estimator-of-the-cumulative-risk/survival"><a class="docs-heading-anchor" href="#Kaplan-Meier-estimator-of-the-cumulative-risk/survival">Kaplan-Meier estimator of the cumulative risk/survival</a><a id="Kaplan-Meier-estimator-of-the-cumulative-risk/survival-1"></a><a class="docs-heading-anchor-permalink" href="#Kaplan-Meier-estimator-of-the-cumulative-risk/survival" title="Permalink"></a></h1><pre><code class="language-julia hljs">plot(mfit)
savefig(&quot;km.svg&quot;)</code></pre><p><img src="../fig/km.svg" alt="Kaplan-Meier"/></p><h1 id="Checking-whether-marginal-distribution-of-the-outcome-comports-with-a-parametric-Weibull-or-Exponential-model"><a class="docs-heading-anchor" href="#Checking-whether-marginal-distribution-of-the-outcome-comports-with-a-parametric-Weibull-or-Exponential-model">Checking whether marginal distribution of the outcome comports with a parametric Weibull or Exponential model</a><a id="Checking-whether-marginal-distribution-of-the-outcome-comports-with-a-parametric-Weibull-or-Exponential-model-1"></a><a class="docs-heading-anchor-permalink" href="#Checking-whether-marginal-distribution-of-the-outcome-comports-with-a-parametric-Weibull-or-Exponential-model" title="Permalink"></a></h1><ul><li>a straight line implies Weibull</li><li>a flat line implies Exponential (a special case of Weibull)</li></ul><pre><code class="language-julia hljs">lognlogplot(mfit)
savefig(&quot;lognlog.svg&quot;)</code></pre><p><img src="../fig/lognlog.svg" alt="Is-it-Weibull"/></p><h1 id="Competing-event-analysis:-Aalen-Johansen-estimator-of-cumulative-risk"><a class="docs-heading-anchor" href="#Competing-event-analysis:-Aalen-Johansen-estimator-of-cumulative-risk">Competing event analysis: Aalen-Johansen estimator of cumulative risk</a><a id="Competing-event-analysis:-Aalen-Johansen-estimator-of-cumulative-risk-1"></a><a class="docs-heading-anchor-permalink" href="#Competing-event-analysis:-Aalen-Johansen-estimator-of-cumulative-risk" title="Permalink"></a></h1><pre><code class="language-julia hljs">using Random, LSurvival, Distributions, LinearAlgebra

# simulate some data
z, x, t, d, event, wt = LSurvival.dgm_comprisk(MersenneTwister(122), 1000)
X = hcat(x,z)
enter = t .* rand(length(d))*0.02 # create some fake entry times

res_aj = aalen_johansen(enter, t, event; wts = wt);
res_aj</code></pre><pre><code class="language-output hljs">Kaplan-Meier Survival, Aalen-Johansen risk
─────────────────────────────────────────────────────────────────────────────────────
      time  survival  # events (j=1)  # events (j=2)  at risk  risk (j=1)  risk (j=2)
─────────────────────────────────────────────────────────────────────────────────────
1   0.0022  0.998931          0.159           0.0     148.803  0.00106852  0.0
2   0.0038  0.996398          0.5814          0.0     229.219  0.00360225  0.0
3   0.0054  0.990389          0.0             1.8427  305.564  0.00360225  0.00600876
4   0.0111  0.989562          0.0             0.4837  579.421  0.00360225  0.00683553
5   0.0174  0.988695          0.781           0.0     891.278  0.00446938  0.00683553
6   0.0254  0.986939          0.0             1.7696  996.153  0.00446938  0.00859189
7   0.0288  0.986575          0.3667          0.0     994.383  0.00483333  0.00859189
8   0.0298  0.986399          0.0             0.1767  994.017  0.00483333  0.00876726
9   0.0595  0.984609          1.8042          0.0     993.84   0.00662402  0.00876726
10  0.061   0.983885          0.7293          0.0     992.036  0.00734786  0.00876726
─────────────────────────────────────────────────────────────────────────────────────
...
──────────────────────────────────────────────────────────────────────────────────────
       time  survival  # events (j=1)  # events (j=2)  at risk  risk (j=1)  risk (j=2)
──────────────────────────────────────────────────────────────────────────────────────
97   0.7976  0.895918          0.0             1.9207  904.596   0.0446602   0.0594221
98   0.798   0.894475          1.4537          0.0     902.676   0.046103    0.0594221
99   0.8072  0.893263          1.2212          0.0     901.222   0.0473151   0.0594221
100  0.815   0.89315           0.1138          0.0     900.001   0.047428    0.0594221
101  0.8174  0.892868          0.2843          0.0     899.887   0.0477102   0.0594221
102  0.8309  0.891727          0.0             1.1494  899.603   0.0477102   0.0605629
103  0.8386  0.889767          0.0             1.9746  898.453   0.0477102   0.0625227
104  0.8572  0.889355          0.4151          0.0     896.479   0.0481222   0.0625227
105  0.9051  0.888361          1.0021          0.0     896.064   0.0491168   0.0625227
106  0.9189  0.888032          0.3315          0.0     895.062   0.0494458   0.0625227
──────────────────────────────────────────────────────────────────────────────────────
Number of events (j=1.0):  46.8371
Number of events (j=2.0):  58.4336
Number of unique event times:      106</code></pre><h2 id="Aalen-Johansen-plot:-marginal-cause-specific-risks"><a class="docs-heading-anchor" href="#Aalen-Johansen-plot:-marginal-cause-specific-risks">Aalen-Johansen plot: marginal cause-specific risks</a><a id="Aalen-Johansen-plot:-marginal-cause-specific-risks-1"></a><a class="docs-heading-anchor-permalink" href="#Aalen-Johansen-plot:-marginal-cause-specific-risks" title="Permalink"></a></h2><pre><code class="language-julia hljs">plot(res_aj)
savefig(&quot;aj.svg&quot;)</code></pre><p><img src="../fig/aj.svg" alt="Aalen-Johansen"/></p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../Likelihood/">« Likelihood functions for time-to-event observations subject to left-truncation and right censoring</a><a class="docs-footer-nextpage" href="../coxmodel/">Semi-parametric survival analysis with Cox models »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="auto">Automatic (OS)</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.0.1 on <span class="colophon-date" title="Monday 25 September 2023 11:23">Monday 25 September 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
